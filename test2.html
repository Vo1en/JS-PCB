<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PCBè¦æ ¼ç”¢ç”Ÿå™¨</title>
  <link rel="stylesheet" href="style.css">
  <style>
  /* ================================================= */
  /* === START: ä¾†è‡ª navbar.html çš„ CSS æ¨£å¼ === */
  /* ================================================= */
  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;500;700&family=Roboto:wght@300;400;700&display=swap');

  :root {
      --bg-gradient: linear-gradient(135deg, #fcfaf5 0%, #f0ebde 100%);
      --glass-bg: rgba(255, 255, 255, 0.9);
      --glass-border: rgba(194, 168, 120, 0.6);
      --text-main: #1f2937;
      --text-sub: #6b7280;
      --gold-gradient: linear-gradient(135deg, #c2a878 0%, #e3d1a8 50%, #9e8b6b 100%);
      --gold-text-gradient: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
      --active-color: #c2a878;
  }

  /* å…¨åŸŸ box-sizingï¼Œé¿å…å¯¬åº¦è¶…å‡ºé€ æˆå·¦å³æ»‘å‹• */
  *, *::before, *::after {
      box-sizing: border-box;
  }

  .navbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      width: 100%;
      display: flex;
      align-items: center;
      padding: 10px 16px;
      justify-content: flex-start;
      background-color: var(--glass-bg);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border-bottom: 2px solid var(--glass-border);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      z-index: 1000;
  }

  .brand-logo {
      display: flex;
      align-items: center;
      text-decoration: none;
      padding: 5px 0;
      flex-shrink: 0;
  }

  .text-logo {
      font-family: 'Roboto', sans-serif;
      font-size: 2rem;
      font-weight: 900;
      letter-spacing: -1px;
      background: var(--gold-text-gradient);
      background-size: 200% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.3));
      transition: transform 0.3s, filter 0.3s;
      animation: shine 5s linear infinite;
      white-space: nowrap;
  }

  .brand-logo:hover .text-logo {
      transform: scale(1.05);
      filter: drop-shadow(0 0 5px rgba(194, 168, 120, 0.8))
              drop-shadow(0 2px 3px rgba(0, 0, 0, 0.3));
  }

  .nav-links {
      display: flex;
      gap: 20px;
      margin-left: 30px;
      flex-wrap: nowrap;
  }

  .nav-item {
      text-decoration: none;
      color: var(--text-main);
      font-size: 1rem;
      font-weight: 500;
      padding: 5px 0;
      position: relative;
      transition: color 0.3s;
      white-space: nowrap;
  }

  .nav-item::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 3px;
      background: var(--active-color);
      transition: width 0.3s ease-out, left 0.3s ease-out;
      border-radius: 2px;
  }

  .nav-item:hover {
      color: var(--active-color);
  }
  
  .nav-item.current {
      color: var(--active-color);
  }

  .nav-item:hover::after,
  .nav-item.current::after {
      width: 100%;
      left: 0;
  }

  @keyframes shine {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
  }

  /* å¹³æ¿ / æ‰‹æ©Ÿï¼šnavbar æ”¹æˆä¸Šä¸‹å †ç–Šã€ç½®ä¸­ */
  @media (max-width: 768px) {
      .navbar {
          flex-direction: column;
          align-items: center;
          padding: 12px 10px;
          gap: 6px;
          margin-left: 0;
      }
      .text-logo {
          font-size: 1.8rem;
          letter-spacing: -0.5px;
      }
      .nav-links {
          width: 100%;
          justify-content: center;
          flex-wrap: wrap;
          gap: 12px 16px;
      }
      .nav-item {
          font-size: 0.9rem;
      }
      /* èª¿æ•´æ‰‹æ©Ÿç‰ˆ body padding-top ä»¥é©æ‡‰å±•é–‹çš„ navbar */
      /* ä¿®æ”¹ #3: æ¸›å°‘ä¸Šæ–¹ç•™ç™½ï¼Œå¾ 170px æ”¹ç‚º 130pxï¼Œæ¶ˆé™¤å°è¦½åˆ—ä¸‹æ–¹çš„ç°è‰²ç©ºéš™ */
      body {
          padding-top: 130px !important; 
      }
  }
  /* ================================================= */
  /* === END: ä¾†è‡ª navbar.html çš„ CSS æ¨£å¼ === */
  /* ================================================= */

  .logo-wrap {
    text-align: center;
    margin: 12px 0 4px; 
  }
  .logo-wrap img {
    max-width: 300px;
    width: 60%;
    height: auto;
  }

  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    margin: 0;
    padding: 80px 16px 20px 16px;  /* ä¸Šæ–¹é ç•™çµ¦ navbar */
    background: #f5f5f5;
    max-width: 100%;
    overflow-x: hidden;            /* é—œæ‰å·¦å³æ²å‹• */
  }

  /* ç¢ºä¿å…§å®¹ç½®ä¸­ï¼Œä¸¦ä¿ç•™å·¦å³é‚Šè·ä»¥é¿å…å…§å®¹è²¼é‚Š */
  .main-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 0;
  }

  h1 {
    text-align: center;
    font-size: 22px;
    margin-top: 0; 
    margin-bottom: 20px; 
  }
  
  /* å¼·åŒ–å¡ç‰‡è¦–è¦ºæ•ˆæœ */
  .card {
    background: #fff;
    border-radius: 12px; 
    padding: 24px; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
  }
  
  /* æ¬„ä½çµ„ä»¶é–“è·æ›´æ¸…æ™° */
  .field-group {
    display: grid;
    grid-template-columns: 100px 1fr; 
    gap: 12px; 
    margin-bottom: 15px; 
    align-items: center;
  }
  
  label {
    font-size: 14px;
    text-align: left;
    color: #333;
    padding-left: 0;
  }
  
  select, input, textarea {
    width: 100%;
    padding: 8px 10px; 
    font-size: 14px;
    border-radius: 8px; 
    border: 1px solid #ccc;
    box-sizing: border-box;
    background-color: #fff;
  }
  select:disabled {
    background-color: #eee;
    color: #888;
  }
  
  textarea#remark {
    min-height: 90px; 
    resize: vertical;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; 
  }

  /* æŒ‰éˆ•å€å¡Šé–“è·èˆ‡ç½®ä¸­ */
  .btn-row {
    display: flex;
    justify-content: center; 
    gap: 15px; 
    margin: 30px 0; 
  }
  button {
    border: none;
    border-radius: 999px;
    padding: 10px 20px; 
    font-size: 15px;
    cursor: pointer;
    background: #2563eb;
    color: #fff;
    transition: background 0.2s; 
  }
  button:hover {
    background: #1d4ed8;
  }
  button.secondary {
    background: #6b7280;
  }
  
  /* è¼¸å‡ºè¨Šæ¯å€å¡Š */
  .output-area {
    margin-top: 15px;
  }

  .output-area label {
    text-align: left; 
    display: block;
    margin-bottom: 4px;
  }

  /* é€™è£¡æ‹‰é«˜è¼¸å‡ºæ¬„ä½ï¼Œè®“å…§å®¹ä¸€æ¬¡å¤šä¸€é» */
  textarea#output {
    width: 100%;
    margin-top: 0;
    min-height: 350px;  /* æ¡Œæ©Ÿç‰ˆé è¨­é«˜åº¦åŠ é•· */
    font-family: Menlo, Consolas, monospace; 
    line-height: 1.5;
  }
  
  .warning {
    grid-column: 2 / span 1;
    color: red;
    font-size: 13px;
    margin-top: -6px;
  }

  /* ğŸ”» æ‰‹æ©Ÿç‰ˆæ¨£å¼ */
  @media (max-width: 600px) {
    .main-container {
      margin: 8px auto;
      padding: 0; 
      max-width: 100%;
    }
    
    body {
      padding: 130px 10px 20px 10px; /* æ‰‹æ©Ÿç‰ˆä¹ŸåŒæ­¥èª¿æ•´ padding */
      overflow-x: hidden;
    }

    h1 {
      font-size: 18px;
      margin-bottom: 12px;
    }
    .card {
      padding: 18px 14px; 
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
    }
    .field-group {
      grid-template-columns: 1fr;
      gap: 4px;
      margin-bottom: 12px;
    }
    label {
      text-align: left;
      font-size: 13px;
      margin-bottom: 2px;
    }
    select, input, textarea {
      font-size: 14px;
      padding: 7px 9px;
    }
    .btn-row {
      flex-direction: column;
      justify-content: stretch;
      margin: 15px 0;
    }
    .btn-row button {
      width: 100%;
    }
    .warning {
      grid-column: 1 / -1;
      font-size: 12px;
      margin-top: 0;
    }
    .logo-wrap img {
      max-width: 180px;
      width: 70%;
    }
    textarea#output {
      min-height: 300px;  /* æ‰‹æ©Ÿç‰ˆä¹Ÿæ¯”åŸæœ¬æ›´é«˜ä¸€é» */
      font-size: 13px;
    }
  }
</style>
</head>
<body>

<nav class="navbar">
  <a href="index.html" class="brand-logo">
    <span class="text-logo">JS PCB</span>
  </a>

  <div class="nav-links">
    <a href="index.html" class="nav-item">é¦–é </a>
    <a href="PCB Order Info Generator.html" class="nav-item current">PCBè¦æ ¼ç”¢ç”Ÿå™¨</a>
    <a href="PCB Inspection Report.html" class="nav-item">å‡ºè²¨æª¢é©—å ±å‘Š</a>
    <a href="PCB Test Report.html" class="nav-item">é›»æ€§æ¸¬è©¦å ±å‘Š</a>
  </div>
</nav>

<div class="main-container">
  <div class="card">
    <div class="logo-wrap">
      <img src="pic/JS_LOGO.png" alt="JS PCB Logo">
    </div>
    <h1>PCB è¦æ ¼ç”¢ç”Ÿå™¨</h1>
    
    <div class="field-group">
      <label for="partNo">æ–™è™Ÿ</label>
      <input type="text" id="partNo" placeholder="è«‹è¼¸å…¥æ–™è™Ÿ" />
    </div>

    <div class="field-group">
      <label for="material">æ¿æ</label>
      <select id="material" onchange="updateStates()">
        <option>-</option>
        <option selected>FR-4</option>
        <option>FR-1</option>
        <option>é‹åŸºæ¿</option>
      </select>
      <div id="materialWarning" class="warning" style="display:none;">
        FR-1 äº¤æœŸè¼ƒé•·ï¼Œå»ºè­°ä»¥ FR-4 è£½ä½œ
      </div>
    </div>

    <div class="field-group">
      <label for="layers">å±¤åˆ¥</label>
      <select id="layers" onchange="updateStates">
        <option>-</option>
        <option>å–®é¢æ¿</option>
        <option selected>é›™é¢æ¿</option>
        <option>å››å±¤æ¿</option>
        <option>å…­å±¤æ¿</option>
        <option>å…«å±¤æ¿</option>
        <option>åå±¤æ¿</option>
      </select>
    </div>

    <div class="field-group">
      <label for="thickness">æ¿åš</label>
      <select id="thickness" onchange="updateStates()">
        <option>-</option>
        <option>0.4mm</option>
        <option>0.6mm</option>
        <option>0.8mm</option>
        <option>1.0mm</option>
        <option>1.2mm</option>
        <option selected>1.6mm</option>
        <option>2.0mm</option>
        <option>2.4mm</option>
        <option>3.0mm</option>
        <option>3.2mm</option>
      </select>
      <div id="thicknessWarning" class="warning" style="display:none;">
        æ¿åš 0.4mm å¤ªè–„ï¼Œç„¡æ³•é€²è¡Œ V-Cutã€‚è‹¥éœ€æ‹¼æ¿ï¼Œå»ºè­°æ¡ç”¨éƒµç¥¨å­”è¨­è¨ˆã€‚
      </div>
    </div>

    <div class="field-group">
      <label for="innerCu">å…§å±¤éŠ…åš</label>
      <select id="innerCu">
        <option>-</option>
        <option>0.5oz</option>
        <option>1oz</option>
        <option>2oz</option>
      </select>
      <div id="innerCuWarning" class="warning" style="display:none;">
        å–®é¢æ¿ã€é›™é¢æ¿ä¸æ”¯æ´å…§å±¤éŠ…åš
      </div>
    </div>

    <div class="field-group">
      <label for="outerCu">å¤–å±¤éŠ…åš</label>
      <select id="outerCu">
        <option>-</option>
        <option selected>1oz</option>
        <option>2oz</option>
        <option>3oz</option>
      </select>
    </div>

    <div class="field-group">
      <label for="solderMask">é˜²ç„Šé¡è‰²</label>
      <select id="solderMask">
        <option>-</option>
        <option value="ç¶ è‰²" selected>ğŸŸ¢ ç¶ è‰²</option>
        <option value="è—è‰²">ğŸ”µ è—è‰²</option>
        <option value="é»‘è‰²">âš« é»‘è‰²</option>
        <option value="ç™½è‰²">âšª ç™½è‰²</option>
        <option value="ç´…è‰²">ğŸ”´ ç´…è‰²</option>
        <option value="é»ƒè‰²">ğŸŸ¡ é»ƒè‰²</option>
        <option value="ç„¡"> ç„¡</option>
      </select>
    </div>

    <div class="field-group">
      <label for="legendColor">æ–‡å­—é¡è‰²</label>
      <select id="legendColor">
        <option>-</option>
        <option value="ç™½å­—" selected>âšª ç™½å­—</option>
        <option value="é»‘å­—">âš« é»‘å­—</option>
        <option value="ç„¡æ–‡å­—">ç„¡æ–‡å­—</option>
      </select>
    </div>

    <div class="field-group">
      <label for="finish">è¡¨é¢è™•ç†</label>
      <select id="finish">
        <option value="-">-</option>
        <option value="æœ‰é‰›å™´éŒ«">æœ‰é‰›å™´éŒ«</option>
        <option value="ç„¡é‰›å™´éŒ«" selected>ç„¡é‰›å™´éŒ«</option>
        <option value="åŒ–é‡‘ 1u">åŒ–é‡‘ 1u</option>
        <option value="åŒ–é‡‘ 2u">åŒ–é‡‘ 2u</option>
        <option value="åŒ–é‡‘ 3u">åŒ–é‡‘ 3u</option>
        <option value="ç¡¬é‡‘ 3u">ç¡¬é‡‘ 3u</option>
        <option value="ç¡¬é‡‘ 5u">ç¡¬é‡‘ 5u</option>
        <option value="OSP">OSP</option>
        <option value="è£¸éŠ…">è£¸éŠ…</option>
      </select>
      <div id="finishWarning" class="warning" style="display:none;">
        å…­å±¤æ¿ä»¥ä¸Šï¼Œçµ±ä¸€è£½åšåŒ–é‡‘ 2u è¡¨é¢è™•ç†
      </div>
    </div>

    <div class="field-group">
      <label for="goldFinger">é‡‘(éŒ«)æ‰‹æŒ‡</label>
      <select id="goldFinger">
        <option>-</option>
        <option>æ–œé‚Š30Â°</option>
        <option>æ–œé‚Š45Â°</option>
      </select>
    </div>

    <div class="field-group">
      <label for="qty">æ•¸é‡(å‡ºè²¨ç‰‡)</label>
      <select id="qty">
        <option>-</option>
        <option selected>5</option>
        <option>10</option>
        <option>15</option>
        <option>20</option>
        <option>25</option>
        <option>30</option>
        <option>50</option>
        <option>75</option>
        <option>100</option>
        <option>125</option>
        <option>150</option>
        <option>200</option>
      </select>
    </div>

    <div class="field-group">
      <label for="special1">ç‰¹æ®Šè£½ç¨‹#1</label>
      <select id="special1">
        <option>-</option>
        <option>åŠå­”</option>
        <option>å¡å­”</option>
        <option>æ¨¹è„‚å¡å­”</option>
        <option>BGA</option>
        <option>å´é‚ŠééŠ…</option>
      </select>
      <div id="special1Warning" class="warning" style="display:none;">
        å…­å±¤æ¿ä»¥ä¸Šï¼Œçµ±ä¸€è£½ä½œæ¨¹è„‚å¡å­”è£½ç¨‹
      </div>
    </div>

    <div class="field-group">
      <label for="special2">ç‰¹æ®Šè£½ç¨‹#2</label>
      <select id="special2">
        <option>-</option>
        <option>åŠå­”</option>
        <option>å¡å­”</option>
        <option>æ¨¹è„‚å¡å­”</option>
        <option>BGA</option>
        <option>å´é‚ŠééŠ…</option>
      </select>
    </div>

    <div class="field-group">
      <label for="special3">ç‰¹æ®Šè£½ç¨‹#3</label>
      <select id="special3">
        <option>-</option>
        <option>åŠå­”</option>
        <option>å¡å­”</option>
        <option>æ¨¹è„‚å¡å­”</option>
        <option>BGA</option>
        <option>å´é‚ŠééŠ…</option>
      </select>
    </div>

    <div class="field-group">
      <label for="specialAmount">è¨‚å–®é‡‘é¡</label>
      <input type="text" id="specialAmount" inputmode="numeric" oninput="formatNumber(this)" placeholder="è«‹è¼¸å…¥é‡‘é¡" />
    </div>

    <div class="field-group">
      <label for="remark">å‚™è¨»</label>
      <textarea id="remark" placeholder="å¦‚æœ‰å…¶ä»–éœ€æ±‚æˆ–æ³¨æ„äº‹é …ï¼Œè«‹æ–¼æ­¤æ¬„è©³ç´°èªªæ˜"></textarea>
    </div>

    <div class="btn-row">
      <button type="button" onclick="generateText()">ç”¢ç”Ÿè¨Šæ¯</button>
      <button type="button" class="secondary" onclick="copyText()">è¤‡è£½è¨Šæ¯</button>
    </div>

    <div class="output-area">
      <label for="output">ç”¢ç”Ÿè¨Šæ¯</label>
      <textarea id="output" readonly></textarea>
    </div>
  </div>
</div>

<script>
  // ä¿®æ”¹ #1: æ–°å¢æ ¼å¼åŒ–æ•¸å­—çš„å‡½å¼
  function formatNumber(input) {
    // ç§»é™¤éæ•¸å­—çš„å­—å…ƒ
    var value = input.value.replace(/\D/g, "");
    // å¦‚æœæœ‰å€¼ï¼Œå‰‡åŠ ä¸Šåƒåˆ†ä½é€—è™Ÿ
    if (value) {
      input.value = Number(value).toLocaleString("en-US");
    } else {
      input.value = "";
    }
  }

  function updateStates() {
    var layer        = document.getElementById("layers").value;
    var layersSel    = document.getElementById("layers");
    var innerSelect  = document.getElementById("innerCu");
    var innerWarn    = document.getElementById("innerCuWarning");
    var thicknessSel = document.getElementById("thickness");
    var thicknessWarn= document.getElementById("thicknessWarning");
    var outerCuSel   = document.getElementById("outerCu");
    var finishSelect = document.getElementById("finish");
    var finishWarn   = document.getElementById("finishWarning");
    var special1Sel  = document.getElementById("special1");
    var special1Warn = document.getElementById("special1Warning");
    var special2Sel  = document.getElementById("special2");
    var special3Sel  = document.getElementById("special3");
    var goldFingerSel= document.getElementById("goldFinger");
    var materialSel  = document.getElementById("material");
    var materialWarn = document.getElementById("materialWarning");

    var i, opt;

    if (thicknessWarn) {
      thicknessWarn.style.display = "none";
    }

    if (materialSel && materialWarn) {
      if (materialSel.value === "FR-1") {
        materialWarn.style.display = "block";
      } else {
        materialWarn.style.display = "none";
      }
    }

    for (i = 0; i < thicknessSel.options.length; i++) {
      thicknessSel.options[i].disabled = false;
    }
    for (i = 0; i < outerCuSel.options.length; i++) {
      outerCuSel.options[i].disabled = false;
    }
    for (i = 0; i < layersSel.options.length; i++) {
      layersSel.options[i].disabled = false;
    }
    goldFingerSel.disabled = false;
    special1Sel.disabled = false;
    special2Sel.disabled = false;
    special3Sel.disabled = false;
    special1Warn.style.display = "none";
    finishSelect.disabled = false;
    finishWarn.style.display = "none";

    if (materialSel.value === "FR-1") {
      for (i = 0; i < layersSel.options.length; i++) {
        opt = layersSel.options[i];
        if (opt.value !== "-" && opt.value !== "å–®é¢æ¿") {
          opt.disabled = true;
        }
      }
      if (layersSel.value !== "å–®é¢æ¿") {
        layersSel.value = "å–®é¢æ¿";
        layer = "å–®é¢æ¿";
      }

      for (i = 0; i < thicknessSel.options.length; i++) {
        opt = thicknessSel.options[i];
        opt.disabled = (opt.value !== "1.6mm");
      }
      thicknessSel.value = "1.6mm";

      for (i = 0; i < outerCuSel.options.length; i++) {
        opt = outerCuSel.options[i];
        opt.disabled = (opt.value !== "1oz");
      }
      outerCuSel.value = "1oz";

      goldFingerSel.value = "-";
      goldFingerSel.disabled = true;

      special1Sel.value = "-";
      special2Sel.value = "-";
      special3Sel.value = "-";
      special1Sel.disabled = true;
      special2Sel.disabled = true;
      special3Sel.disabled = true;

      innerSelect.disabled = true;
      innerSelect.value = "-";
      innerWarn.style.display = "block";

      if (thicknessWarn) thicknessWarn.style.display = "none";

      return;
    }

    if (layer === "å–®é¢æ¿" || layer === "é›™é¢æ¿") {
      innerSelect.disabled = true;
      innerSelect.value = "-";
      innerWarn.style.display = "block";
    } else if (
      layer === "å››å±¤æ¿" ||
      layer === "å…­å±¤æ¿" ||
      layer === "å…«å±¤æ¿" ||
      layer === "åå±¤æ¿"
    ) {
      innerSelect.disabled = false;
      innerWarn.style.display = "none";
      if (innerSelect.value === "-" || innerSelect.value === "") {
        innerSelect.value = "0.5oz";
      }
    } else {
      innerSelect.disabled = false;
      innerWarn.style.display = "none";
    }

    if (
      layer === "å››å±¤æ¿" ||
      layer === "å…­å±¤æ¿" ||
      layer === "å…«å±¤æ¿" ||
      layer === "åå±¤æ¿"
    ) {
      for (i = 0; i < thicknessSel.options.length; i++) {
        opt = thicknessSel.options[i];
        if (opt.value === "0.4mm") opt.disabled = true;
      }
    }

    if (layer === "å…«å±¤æ¿" || layer === "åå±¤æ¿") {
      for (i = 0; i < thicknessSel.options.length; i++) {
        opt = thicknessSel.options[i];
        if (opt.value === "0.6mm") opt.disabled = true;
      }
    }

    var currentThicknessOpt = thicknessSel.options[thicknessSel.selectedIndex];
    if (currentThicknessOpt && currentThicknessOpt.disabled) {
      thicknessSel.value = "1.6mm";
    }

    currentThicknessOpt = thicknessSel.options[thicknessSel.selectedIndex];
    if (
      thicknessWarn &&
      thicknessSel.value === "0.4mm" &&
      currentThicknessOpt &&
      !currentThicknessOpt.disabled
    ) {
      thicknessWarn.style.display = "block";
    } else if (thicknessWarn) {
      thicknessWarn.style.display = "none";
    }

    if (layer === "å…­å±¤æ¿" || layer === "å…«å±¤æ¿" || layer === "åå±¤æ¿") {
      finishSelect.value = "åŒ–é‡‘ 2u";
      finishSelect.disabled = true;
      finishWarn.style.display = "block";
    }

    if (layer === "å…­å±¤æ¿" || layer === "å…«å±¤æ¿" || layer === "åå±¤æ¿") {
      special1Sel.value = "æ¨¹è„‚å¡å­”";
      special1Sel.disabled = true;
      special1Warn.style.display = "block";
    }
  }

  function trim(str) {
    return str.replace(/^\s+|\s+$/g, "");
  }

  function getValue(id) {
    var el = document.getElementById(id);
    if (!el) return "-";
    var v = trim(el.value);
    return v || "-";
  }

  function generateText() {
    var now = new Date();
    var timeStr =
      now.getFullYear() + "/" +
      String(now.getMonth() + 1).padStart(2, "0") + "/" +
      String(now.getDate()).padStart(2, "0") + " " +
      String(now.getHours()).padStart(2, "0") + ":" +
      String(now.getMinutes()).padStart(2, "0");

    var partNo      = getValue("partNo");
    var material    = getValue("material");
    var layers      = getValue("layers");
    var thickness   = getValue("thickness");
    var innerCu     = getValue("innerCu");
    var outerCu     = getValue("outerCu");
    var solderMask  = getValue("solderMask");
    var legendColor = getValue("legendColor");
    var finish      = getValue("finish");
    var goldFinger  = getValue("goldFinger");
    var qtyVal      = getValue("qty");
    var remark      = trim(document.getElementById("remark").value || "");

    var specialAmountEl = document.getElementById("specialAmount");
    var specialAmount = "";
    if (specialAmountEl) {
      // ä¿®æ”¹ #1: å–å¾—è¼¸å…¥å€¼å¾Œï¼Œå…ˆç§»é™¤é€—è™Ÿä»¥ä¾¿å¾ŒçºŒè™•ç†ï¼ˆé›–ç„¶é€™è£¡åªæ˜¯é¡¯ç¤ºï¼Œä½†ä¿æŒæ•¸å€¼ä¹¾æ·¨æ˜¯å¥½ç¿’æ…£ï¼‰
      var rawVal = trim(specialAmountEl.value || "");
      // å¦‚æœå·²ç¶“æ ¼å¼åŒ–éï¼Œç›´æ¥ä½¿ç”¨è©²å­—ä¸²ï¼Œæˆ–è€…å…ˆç§»é™¤é€—è™Ÿå†é‡æ–°æ ¼å¼åŒ–ç¢ºèª
      var cleanVal = rawVal.replace(/,/g, ""); 
      
      if (cleanVal) {
        specialAmount = Number(cleanVal).toLocaleString("en-US");
      }
    }
    
    var specialsIds = ["special1", "special2", "special3"];
    var specials = [];
    for (var i = 0; i < specialsIds.length; i++) {
      var el = document.getElementById(specialsIds[i]);
      if (!el) continue;
      var v = trim(el.value || "");
      if (v && v !== "-") specials.push(v);
    }

    var lines = [
      "æ–™è™Ÿï¼š" + partNo,
      "æ¿æï¼š" + material,
      "å±¤åˆ¥ï¼š" + layers,
      "æ¿åšï¼š" + thickness
    ];

    if (layers !== "å–®é¢æ¿" && layers !== "é›™é¢æ¿") {
      lines.push("å…§å±¤éŠ…åšï¼š" + innerCu);
    }

    lines.push(
      "å¤–å±¤éŠ…åšï¼š" + outerCu,
      "é˜²ç„Šé¡è‰²ï¼š" + solderMask,
      "æ–‡å­—é¡è‰²ï¼š" + legendColor,
      "è¡¨é¢è™•ç†ï¼š" + finish
    );

    if (goldFinger !== "-" && goldFinger !== "") {
      lines.push("é‡‘(éŒ«)æ‰‹æŒ‡ï¼š" + goldFinger);
    }

    lines.push("æ•¸é‡(å‡ºè²¨ç‰‡)ï¼š" + qtyVal);

    if (specials.length > 0) {
      lines.push("ç‰¹æ®Šè£½ç¨‹ï¼š" + specials.join("ã€"));
    }

    if (specialAmount) {
      lines.push("è¨‚å–®é‡‘é¡ï¼š" + specialAmount + "å…ƒ");
    }

    var msg = lines.join("\n");
    if (remark) {
      msg += "\n\nå‚™è¨»ï¼š" + remark;
    }

    msg = timeStr + "\n" + msg;

    document.getElementById("output").value = msg;
  }

  function copyText() {
    var out = document.getElementById("output");
    if (!trim(out.value || "")) {
      generateText();
    }
    out.focus();
    out.select();
    try {
      var ok = document.execCommand("copy");
      if (ok) {
        alert("å·²è¤‡è£½è¨Šæ¯ï¼");
      } else {
        alert("ç„¡æ³•è‡ªå‹•è¤‡è£½ï¼Œè«‹é•·æŒ‰æ‰‹å‹•è¤‡è£½æ–‡å­—ã€‚");
      }
    } catch (e) {
      alert("ç„¡æ³•è‡ªå‹•è¤‡è£½ï¼Œè«‹é•·æŒ‰æ‰‹å‹•è¤‡è£½æ–‡å­—ã€‚");
    }
  }

  document.addEventListener('DOMContentLoaded', updateStates);
  updateStates();
</script>

</body>
</html>
