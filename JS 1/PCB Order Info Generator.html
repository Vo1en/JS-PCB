<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PCBè¦æ ¼ç”¢ç”Ÿå™¨</title>
  
  <link rel="stylesheet" href="navbar.css">
  <link rel="stylesheet" href="style.css">
  
  <style>
  /* å…¨åŸŸ box-sizing */
  *, *::before, *::after {
      box-sizing: border-box;
  }

  /* ä¿ç•™åŸæœ¬é‡å°æ­¤é é¢çš„æ¨£å¼å¾®èª¿ */
  .logo-wrap {
    text-align: center;
    margin: 12px 0 4px; 
  }
  .logo-wrap img {
    max-width: 300px;
    width: 60%;
    height: auto;
  }

  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    margin: 0;
    /* ä¸Šæ–¹é ç•™çµ¦ navbar */
    padding: 110px 16px 20px 16px;  
    background: #f5f5f5;
    max-width: 100%;
    overflow-x: hidden;
  }

  .main-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 0;
  }

  h1 {
    text-align: center;
    font-size: 22px;
    margin-top: 0; 
    margin-bottom: 20px; 
    font-weight: 700;
  }
  
  .card {
    background: #fff;
    border-radius: 12px; 
    padding: 24px; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
  }
  
  .field-group {
    display: grid;
    grid-template-columns: 100px 1fr; 
    gap: 12px; 
    margin-bottom: 15px; 
    align-items: center;
  }
  
  label {
    font-size: 14px;
    text-align: left;
    color: #333;
    padding-left: 0;
    font-weight: 700; 
  }
  
  .select-container {
    width: 100%;
    position: relative;
  }

  select, input, textarea {
    width: 100%;
    padding: 8px 10px; 
    font-size: 14px;
    border-radius: 8px; 
    border: 1px solid #ccc;
    box-sizing: border-box;
    background-color: #fff;
  }
  select:disabled {
    background-color: #eee;
    color: #888;
  }

  .custom-input-wrapper {
    display: none;
    width: 100%;
    gap: 8px;
    align-items: center;
  }
  
  .custom-input-wrapper input {
    flex-grow: 1;
  }

  .reset-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    padding: 0;
    background: #9ca3af;
    color: white;
    border: none;
    font-size: 18px;
    line-height: 1;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  .reset-btn:hover {
    background: #6b7280;
  }
  
  textarea#remark {
    min-height: 90px; 
    resize: vertical;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; 
  }

  .btn-row {
    display: flex;
    justify-content: center; 
    gap: 15px; 
    margin: 30px 0; 
  }
  button {
    border: none;
    border-radius: 999px;
    padding: 10px 20px; 
    font-size: 15px;
    cursor: pointer;
    background: #2563eb;
    color: #fff;
    transition: background 0.2s; 
    font-weight: 500;
  }
  button:hover {
    background: #1d4ed8;
  }
  button.secondary {
    background: #6b7280;
  }
  
  .output-area {
    margin-top: 15px;
  }

  .output-area label {
    text-align: left; 
    display: block;
    margin-bottom: 4px;
  }

  textarea#output {
    width: 100%;
    margin-top: 0;
    min-height: 350px;
    font-family: Menlo, Consolas, monospace; 
    line-height: 1.5;
  }
  
  .warning {
    grid-column: 2 / span 1;
    color: red;
    font-size: 13px;
    margin-top: -6px;
  }

  /* æ‰‹æ©Ÿç‰ˆæ¨£å¼å¾®èª¿ */
  @media (max-width: 600px) {
    .main-container {
      margin: 0 auto;
      padding: 0; 
      max-width: 100%;
    }
    
    body {
      padding: 80px 10px 20px 10px; /* æ‰‹æ©Ÿç‰ˆé‡å°æ­¤é é¢çš„ padding */
      overflow-x: hidden;
    }

    h1 {
      font-size: 18px;
      margin-bottom: 12px;
    }
    .card {
      padding: 18px 14px; 
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
    }
    .field-group {
      grid-template-columns: 1fr;
      gap: 4px;
      margin-bottom: 12px;
    }
    label {
      text-align: left;
      font-size: 13px;
      margin-bottom: 2px;
    }
    select, input, textarea {
      font-size: 14px;
      padding: 7px 9px;
    }
    .btn-row {
      flex-direction: column;
      justify-content: stretch;
      margin: 15px 0;
    }
    .btn-row button {
      width: 100%;
    }
    .warning {
      grid-column: 1 / -1;
      font-size: 12px;
      margin-top: 0;
    }
    .logo-wrap img {
      max-width: 180px;
      width: 70%;
    }
    textarea#output {
      min-height: 300px;
      font-size: 13px;
    }
  }
  
  /* é‡å°æ­¤é é¢çš„ navbar æ‰‹æ©Ÿç‰ˆä¿®æ­£ */
  @media (max-width: 768px) {
      /* ç”±æ–¼ navbar.css å·²ç¶“è¨­å®šå¥½é«˜åº¦ï¼Œé€™è£¡åªè¦ç¢ºä¿ body padding è¶³å¤ å³å¯
         åŸæœ¬ä»£ç¢¼ç‚º padding-top: 105px !important; å·²ä¿ç•™åœ¨ä¸Šæ–¹
      */
  }
</style>
</head>
<body>

<div id="navbar-container"></div>
<script src="navbar.js"></script>

<div class="main-container">
  <div class="card">
    <div class="logo-wrap">
      <img src="pic/JS_LOGO.png" alt="JS PCB Logo" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x100?text=JS+PCB';">
    </div>
    <h1>PCB è¦æ ¼ç”¢ç”Ÿå™¨</h1>
    
    <div class="field-group">
      <label for="partNo">æ–™è™Ÿ</label>
      <input type="text" id="partNo" placeholder="è«‹è¼¸å…¥æ–™è™Ÿ" />
    </div>

    <div class="field-group">
      <label for="material">æ¿æ</label>
      <div class="select-container">
        <select id="material" onchange="onSelectChange(this)">
          <option>-</option>
          <option selected>FR-4</option>
          <option>FR-1</option>
          <option>é‹åŸºæ¿</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="material_custom_div" class="custom-input-wrapper">
          <input type="text" id="material_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥æ¿æ" />
          <button type="button" class="reset-btn" onclick="resetSelect('material')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
      <div id="materialWarning" class="warning" style="display:none;">
        FR-1 äº¤æœŸè¼ƒé•·ï¼Œå»ºè­°ä»¥ FR-4 è£½ä½œ
      </div>
    </div>

    <div class="field-group">
      <label for="layers">å±¤åˆ¥</label>
      <div class="select-container">
        <select id="layers" onchange="onSelectChange(this)">
          <option>-</option>
          <option>å–®é¢æ¿</option>
          <option selected>é›™é¢æ¿</option>
          <option>å››å±¤æ¿</option>
          <option>å…­å±¤æ¿</option>
          <option>å…«å±¤æ¿</option>
          <option>åå±¤æ¿</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="layers_custom_div" class="custom-input-wrapper">
          <input type="text" id="layers_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥å±¤åˆ¥" />
          <button type="button" class="reset-btn" onclick="resetSelect('layers')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
    </div>

    <div class="field-group">
      <label for="thickness">æ¿åš</label>
      <div class="select-container">
        <select id="thickness" onchange="onSelectChange(this)">
          <option>-</option>
          <option>0.4mm</option>
          <option>0.6mm</option>
          <option>0.8mm</option>
          <option>1.0mm</option>
          <option>1.2mm</option>
          <option selected>1.6mm</option>
          <option>2.0mm</option>
          <option>2.4mm</option>
          <option>3.0mm</option>
          <option>3.2mm</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="thickness_custom_div" class="custom-input-wrapper">
          <input type="text" id="thickness_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥æ¿åš" />
          <button type="button" class="reset-btn" onclick="resetSelect('thickness')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
      <div id="thicknessWarning" class="warning" style="display:none;">
        æ¿åš 0.4mm å¤ªè–„ï¼Œç„¡æ³•é€²è¡Œ V-Cutã€‚è‹¥éœ€æ‹¼æ¿ï¼Œå»ºè­°æ¡ç”¨éƒµç¥¨å­”è¨­è¨ˆã€‚
      </div>
    </div>

    <div class="field-group">
      <label for="innerCu">å…§å±¤éŠ…åš</label>
      <div class="select-container">
        <select id="innerCu" onchange="checkCustom(this)">
          <option>-</option>
          <option>0.5oz</option>
          <option>1oz</option>
          <option>2oz</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="innerCu_custom_div" class="custom-input-wrapper">
          <input type="text" id="innerCu_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥å…§å±¤éŠ…åš" />
          <button type="button" class="reset-btn" onclick="resetSelect('innerCu')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
      <div id="innerCuWarning" class="warning" style="display:none;">
        å–®é¢æ¿ã€é›™é¢æ¿ä¸æ”¯æ´å…§å±¤éŠ…åš
      </div>
    </div>

    <div class="field-group">
      <label for="outerCu">å¤–å±¤éŠ…åš</label>
      <div class="select-container">
        <select id="outerCu" onchange="checkCustom(this)">
          <option>-</option>
          <option selected>1oz</option>
          <option>2oz</option>
          <option>3oz</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="outerCu_custom_div" class="custom-input-wrapper">
          <input type="text" id="outerCu_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥å¤–å±¤éŠ…åš" />
          <button type="button" class="reset-btn" onclick="resetSelect('outerCu')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
    </div>

    <div class="field-group">
      <label for="solderMask">é˜²ç„Šé¡è‰²</label>
      <div class="select-container">
        <select id="solderMask" onchange="checkCustom(this)">
          <option>-</option>
          <option value="ç¶ è‰²" selected>ğŸŸ¢ ç¶ è‰²</option>
          <option value="è—è‰²">ğŸ”µ è—è‰²</option>
          <option value="é»‘è‰²">âš« é»‘è‰²</option>
          <option value="ç™½è‰²">âšª ç™½è‰²</option>
          <option value="ç´…è‰²">ğŸ”´ ç´…è‰²</option>
          <option value="é»ƒè‰²">ğŸŸ¡ é»ƒè‰²</option>
          <option value="ç„¡"> ç„¡</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="solderMask_custom_div" class="custom-input-wrapper">
          <input type="text" id="solderMask_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥é˜²ç„Šé¡è‰²" />
          <button type="button" class="reset-btn" onclick="resetSelect('solderMask')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
    </div>

    <div class="field-group">
      <label for="legendColor">æ–‡å­—é¡è‰²</label>
      <div class="select-container">
        <select id="legendColor" onchange="checkCustom(this)">
          <option>-</option>
          <option value="ç™½å­—" selected>âšª ç™½å­—</option>
          <option value="é»‘å­—">âš« é»‘å­—</option>
          <option value="ç„¡æ–‡å­—">ç„¡æ–‡å­—</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="legendColor_custom_div" class="custom-input-wrapper">
          <input type="text" id="legendColor_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥æ–‡å­—é¡è‰²" />
          <button type="button" class="reset-btn" onclick="resetSelect('legendColor')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
    </div>

    <div class="field-group">
      <label for="finish">è¡¨é¢è™•ç†</label>
      <div class="select-container">
        <select id="finish" onchange="checkCustom(this)">
          <option value="-">-</option>
          <option value="æœ‰é‰›å™´éŒ«">æœ‰é‰›å™´éŒ«</option>
          <option value="ç„¡é‰›å™´éŒ«" selected>ç„¡é‰›å™´éŒ«</option>
          <option value="åŒ–é‡‘ 1u">åŒ–é‡‘ 1u</option>
          <option value="åŒ–é‡‘ 2u">åŒ–é‡‘ 2u</option>
          <option value="åŒ–é‡‘ 3u">åŒ–é‡‘ 3u</option>
          <option value="ç¡¬é‡‘ 3u">ç¡¬é‡‘ 3u</option>
          <option value="ç¡¬é‡‘ 5u">ç¡¬é‡‘ 5u</option>
          <option value="OSP">OSP</option>
          <option value="è£¸éŠ…">è£¸éŠ…</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="finish_custom_div" class="custom-input-wrapper">
          <input type="text" id="finish_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥è¡¨é¢è™•ç†" />
          <button type="button" class="reset-btn" onclick="resetSelect('finish')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
      <div id="finishWarning" class="warning" style="display:none;">
        å…­å±¤æ¿ä»¥ä¸Šï¼Œçµ±ä¸€è£½åšåŒ–é‡‘ 2u è¡¨é¢è™•ç†
      </div>
    </div>

    <div class="field-group">
      <label for="goldFinger">é‡‘(éŒ«)æ‰‹æŒ‡</label>
      <div class="select-container">
        <select id="goldFinger" onchange="checkCustom(this)">
          <option>-</option>
          <option>æ–œé‚Š30Â°</option>
          <option>æ–œé‚Š45Â°</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="goldFinger_custom_div" class="custom-input-wrapper">
          <input type="text" id="goldFinger_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥é‡‘(éŒ«)æ‰‹æŒ‡" />
          <button type="button" class="reset-btn" onclick="resetSelect('goldFinger')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
    </div>

    <div class="field-group">
      <label for="qty">æ•¸é‡(å‡ºè²¨ç‰‡)</label>
      <div class="select-container">
        <select id="qty" onchange="checkCustom(this)">
          <option>-</option>
          <option selected>5</option>
          <option>10</option>
          <option>15</option>
          <option>20</option>
          <option>25</option>
          <option>30</option>
          <option>50</option>
          <option>75</option>
          <option>100</option>
          <option>125</option>
          <option>150</option>
          <option>200</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="qty_custom_div" class="custom-input-wrapper">
          <input type="text" id="qty_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥æ•¸é‡" />
          <button type="button" class="reset-btn" onclick="resetSelect('qty')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
    </div>

    <div class="field-group">
      <label for="special1">ç‰¹æ®Šè£½ç¨‹#1</label>
      <div class="select-container">
        <select id="special1" onchange="checkCustom(this)">
          <option>-</option>
          <option>åŠå­”</option>
          <option>å¡å­”</option>
          <option>æ¨¹è„‚å¡å­”</option>
          <option>BGA</option>
          <option>å´é‚ŠééŠ…</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="special1_custom_div" class="custom-input-wrapper">
          <input type="text" id="special1_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥ç‰¹æ®Šè£½ç¨‹" />
          <button type="button" class="reset-btn" onclick="resetSelect('special1')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
      <div id="special1Warning" class="warning" style="display:none;">
        å…­å±¤æ¿ä»¥ä¸Šï¼Œçµ±ä¸€è£½ä½œæ¨¹è„‚å¡å­”è£½ç¨‹
      </div>
    </div>

    <div class="field-group">
      <label for="special2">ç‰¹æ®Šè£½ç¨‹#2</label>
      <div class="select-container">
        <select id="special2" onchange="checkCustom(this)">
          <option>-</option>
          <option>åŠå­”</option>
          <option>å¡å­”</option>
          <option>æ¨¹è„‚å¡å­”</option>
          <option>BGA</option>
          <option>å´é‚ŠééŠ…</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="special2_custom_div" class="custom-input-wrapper">
          <input type="text" id="special2_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥ç‰¹æ®Šè£½ç¨‹" />
          <button type="button" class="reset-btn" onclick="resetSelect('special2')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
    </div>

    <div class="field-group">
      <label for="special3">ç‰¹æ®Šè£½ç¨‹#3</label>
      <div class="select-container">
        <select id="special3" onchange="checkCustom(this)">
          <option>-</option>
          <option>åŠå­”</option>
          <option>å¡å­”</option>
          <option>æ¨¹è„‚å¡å­”</option>
          <option>BGA</option>
          <option>å´é‚ŠééŠ…</option>
          <option value="custom">è‡ªè¡Œè¼¸å…¥</option>
        </select>
        <div id="special3_custom_div" class="custom-input-wrapper">
          <input type="text" id="special3_custom" placeholder="è«‹è‡ªè¡Œè¼¸å…¥ç‰¹æ®Šè£½ç¨‹" />
          <button type="button" class="reset-btn" onclick="resetSelect('special3')" title="åˆ‡æ›å›é¸å–®">Ã—</button>
        </div>
      </div>
    </div>

    <div class="field-group">
      <label for="specialAmount">è¨‚å–®é‡‘é¡</label>
      <input type="text" id="specialAmount" inputmode="numeric" oninput="formatNumber(this)" placeholder="è«‹è¼¸å…¥é‡‘é¡" />
    </div>

    <div class="field-group">
      <label for="remark">å‚™è¨»</label>
      <textarea id="remark" placeholder="å¦‚æœ‰å…¶ä»–éœ€æ±‚æˆ–æ³¨æ„äº‹é …ï¼Œè«‹æ–¼æ­¤æ¬„è©³ç´°èªªæ˜"></textarea>
    </div>

    <div class="btn-row">
      <button type="button" onclick="generateText()">ç”¢ç”Ÿè¨Šæ¯</button>
      <button type="button" class="secondary" onclick="copyText()">è¤‡è£½è¨Šæ¯</button>
    </div>

    <div class="output-area">
      <label for="output">ç”¢ç”Ÿè¨Šæ¯</label>
      <textarea id="output" readonly></textarea>
    </div>
  </div>
</div>

<script>
  // ä¿ç•™åŸæœ¬çš„é‚è¼¯è…³æœ¬ï¼Œå®Œå…¨ä¸è®Š
  function formatNumber(input) {
    var value = input.value.replace(/\D/g, "");
    if (value) {
      input.value = Number(value).toLocaleString("en-US");
    } else {
      input.value = "";
    }
  }

  function checkCustom(selectEl) {
    if (selectEl.value === 'custom') {
      var customDivId = selectEl.id + '_custom_div';
      var customDiv = document.getElementById(customDivId);
      var customInput = document.getElementById(selectEl.id + '_custom');
      if (customDiv) {
        selectEl.style.display = 'none';
        customDiv.style.display = 'flex';
        if(customInput) customInput.focus();
      }
    }
  }

  function resetSelect(selectId) {
    var selectEl = document.getElementById(selectId);
    var customDiv = document.getElementById(selectId + '_custom_div');
    if (selectEl && customDiv) {
      customDiv.style.display = 'none';
      selectEl.style.display = 'block';
      selectEl.value = '-';
      if (selectEl.onchange) {
        onSelectChange(selectEl);
      } else {
         updateStates();
      }
    }
  }

  function onSelectChange(el) {
    checkCustom(el);
    updateStates();
  }

  function updateStates() {
    var layer        = document.getElementById("layers").value;
    var layersSel    = document.getElementById("layers");
    var innerSelect  = document.getElementById("innerCu");
    var innerWarn    = document.getElementById("innerCuWarning");
    var thicknessSel = document.getElementById("thickness");
    var thicknessWarn= document.getElementById("thicknessWarning");
    var outerCuSel   = document.getElementById("outerCu");
    var finishSelect = document.getElementById("finish");
    var finishWarn   = document.getElementById("finishWarning");
    var special1Sel  = document.getElementById("special1");
    var special1Warn = document.getElementById("special1Warning");
    var special2Sel  = document.getElementById("special2");
    var special3Sel  = document.getElementById("special3");
    var goldFingerSel= document.getElementById("goldFinger");
    var materialSel  = document.getElementById("material");
    var materialWarn = document.getElementById("materialWarning");

    var i, opt;

    if (thicknessWarn) {
      thicknessWarn.style.display = "none";
    }

    if (materialSel && materialWarn) {
      if (materialSel.value === "FR-1") {
        materialWarn.style.display = "block";
      } else {
        materialWarn.style.display = "none";
      }
    }

    for (i = 0; i < thicknessSel.options.length; i++) {
      thicknessSel.options[i].disabled = false;
    }
    for (i = 0; i < outerCuSel.options.length; i++) {
      outerCuSel.options[i].disabled = false;
    }
    for (i = 0; i < layersSel.options.length; i++) {
      layersSel.options[i].disabled = false;
    }
    goldFingerSel.disabled = false;
    special1Sel.disabled = false;
    special2Sel.disabled = false;
    special3Sel.disabled = false;
    special1Warn.style.display = "none";
    finishSelect.disabled = false;
    finishWarn.style.display = "none";

    if (materialSel.value === "FR-1") {
      for (i = 0; i < layersSel.options.length; i++) {
        opt = layersSel.options[i];
        if (opt.value !== "-" && opt.value !== "å–®é¢æ¿" && opt.value !== "custom") {
          opt.disabled = true;
        }
      }
      if (layersSel.value !== "å–®é¢æ¿" && layersSel.value !== "custom") {
        layersSel.value = "å–®é¢æ¿";
        layer = "å–®é¢æ¿";
      }

      for (i = 0; i < thicknessSel.options.length; i++) {
        opt = thicknessSel.options[i];
        opt.disabled = (opt.value !== "1.6mm");
      }
      if (thicknessSel.value !== "custom") {
        thicknessSel.value = "1.6mm";
      }

      for (i = 0; i < outerCuSel.options.length; i++) {
        opt = outerCuSel.options[i];
        opt.disabled = (opt.value !== "1oz");
      }
      if (outerCuSel.value !== "custom") {
        outerCuSel.value = "1oz";
      }

      goldFingerSel.value = "-";
      goldFingerSel.disabled = true;

      special1Sel.value = "-";
      special2Sel.value = "-";
      special3Sel.value = "-";
      special1Sel.disabled = true;
      special2Sel.disabled = true;
      special3Sel.disabled = true;

      innerSelect.disabled = true;
      innerSelect.value = "-";
      innerWarn.style.display = "block";

      if (thicknessWarn) thicknessWarn.style.display = "none";

      return;
    }

    if (layer === "å–®é¢æ¿" || layer === "é›™é¢æ¿") {
      innerSelect.disabled = true;
      innerSelect.value = "-";
      innerWarn.style.display = "block";
    } else if (
      layer === "å››å±¤æ¿" ||
      layer === "å…­å±¤æ¿" ||
      layer === "å…«å±¤æ¿" ||
      layer === "åå±¤æ¿"
    ) {
      innerSelect.disabled = false;
      innerWarn.style.display = "none";
      if ((innerSelect.value === "-" || innerSelect.value === "") && innerSelect.value !== "custom") {
        innerSelect.value = "0.5oz";
      }
    } else {
      innerSelect.disabled = false;
      innerWarn.style.display = "none";
    }

    if (
      layer === "å››å±¤æ¿" ||
      layer === "å…­å±¤æ¿" ||
      layer === "å…«å±¤æ¿" ||
      layer === "åå±¤æ¿"
    ) {
      for (i = 0; i < thicknessSel.options.length; i++) {
        opt = thicknessSel.options[i];
        if (opt.value === "0.4mm") opt.disabled = true;
      }
    }

    if (layer === "å…«å±¤æ¿" || layer === "åå±¤æ¿") {
      for (i = 0; i < thicknessSel.options.length; i++) {
        opt = thicknessSel.options[i];
        if (opt.value === "0.6mm") opt.disabled = true;
      }
    }

    var currentThicknessOpt = thicknessSel.options[thicknessSel.selectedIndex];
    if (currentThicknessOpt && currentThicknessOpt.disabled && thicknessSel.value !== "custom") {
      thicknessSel.value = "1.6mm";
    }

    currentThicknessOpt = thicknessSel.options[thicknessSel.selectedIndex];
    if (
      thicknessWarn &&
      thicknessSel.value === "0.4mm" &&
      currentThicknessOpt &&
      !currentThicknessOpt.disabled
    ) {
      thicknessWarn.style.display = "block";
    } else if (thicknessWarn) {
      thicknessWarn.style.display = "none";
    }

    if (layer === "å…­å±¤æ¿" || layer === "å…«å±¤æ¿" || layer === "åå±¤æ¿") {
      if (finishSelect.value !== "custom") {
        finishSelect.value = "åŒ–é‡‘ 2u";
        finishSelect.disabled = true;
        finishWarn.style.display = "block";
      }
    }

    if (layer === "å…­å±¤æ¿" || layer === "å…«å±¤æ¿" || layer === "åå±¤æ¿") {
      if (special1Sel.value !== "custom") {
        special1Sel.value = "æ¨¹è„‚å¡å­”";
        special1Sel.disabled = true;
        special1Warn.style.display = "block";
      }
    }
  }

  function trim(str) {
    return str.replace(/^\s+|\s+$/g, "");
  }

  function getValue(id) {
    var el = document.getElementById(id);
    if (!el) return "-";
    
    if (el.tagName === 'SELECT' && el.value === 'custom') {
      var customInput = document.getElementById(id + '_custom');
      if (customInput) {
        var val = trim(customInput.value);
        return val || ""; 
      }
    }
    
    var v = trim(el.value);
    return v || "-";
  }

  function generateText() {
    var now = new Date();
    var timeStr =
      now.getFullYear() + "/" +
      String(now.getMonth() + 1).padStart(2, "0") + "/" +
      String(now.getDate()).padStart(2, "0") + " " +
      String(now.getHours()).padStart(2, "0") + ":" +
      String(now.getMinutes()).padStart(2, "0");

    var partNo      = getValue("partNo");
    var material    = getValue("material");
    var layers      = getValue("layers");
    var thickness   = getValue("thickness");
    var innerCu     = getValue("innerCu");
    var outerCu     = getValue("outerCu");
    var solderMask  = getValue("solderMask");
    var legendColor = getValue("legendColor");
    var finish      = getValue("finish");
    var goldFinger  = getValue("goldFinger");
    var qtyVal      = getValue("qty");
    var remark      = trim(document.getElementById("remark").value || "");

    var specialAmountEl = document.getElementById("specialAmount");
    var specialAmount = "";
    if (specialAmountEl) {
      var rawVal = trim(specialAmountEl.value || "");
      var cleanVal = rawVal.replace(/,/g, ""); 
      
      if (cleanVal) {
        specialAmount = Number(cleanVal).toLocaleString("en-US");
      }
    }
    
    var specialsIds = ["special1", "special2", "special3"];
    var specials = [];
    for (var i = 0; i < specialsIds.length; i++) {
      var v = getValue(specialsIds[i]);
      if (v && v !== "-") specials.push(v);
    }

    var lines = [
      "æ–™è™Ÿï¼š" + partNo,
      "æ¿æï¼š" + material,
      "å±¤åˆ¥ï¼š" + layers,
      "æ¿åšï¼š" + thickness
    ];

    if (layers !== "å–®é¢æ¿" && layers !== "é›™é¢æ¿") {
      lines.push("å…§å±¤éŠ…åšï¼š" + innerCu);
    }

    lines.push(
      "å¤–å±¤éŠ…åšï¼š" + outerCu,
      "é˜²ç„Šé¡è‰²ï¼š" + solderMask,
      "æ–‡å­—é¡è‰²ï¼š" + legendColor,
      "è¡¨é¢è™•ç†ï¼š" + finish
    );

    if (goldFinger !== "-" && goldFinger !== "") {
      lines.push("é‡‘(éŒ«)æ‰‹æŒ‡ï¼š" + goldFinger);
    }

    lines.push("æ•¸é‡(å‡ºè²¨ç‰‡)ï¼š" + qtyVal);

    if (specials.length > 0) {
      lines.push("ç‰¹æ®Šè£½ç¨‹ï¼š" + specials.join("ã€"));
    }

    if (specialAmount) {
      lines.push("è¨‚å–®é‡‘é¡ï¼š" + specialAmount + "å…ƒ");
    }

    var msg = lines.join("\n");
    if (remark) {
      msg += "\n\nå‚™è¨»ï¼š" + remark;
    }

    msg = timeStr + "\n" + msg;

    document.getElementById("output").value = msg;
  }

  function copyText() {
    var out = document.getElementById("output");
    if (!trim(out.value || "")) {
      generateText();
    }
    out.focus();
    out.select();
    try {
      var ok = document.execCommand("copy");
      if (ok) {
        alert("å·²è¤‡è£½è¨Šæ¯ï¼");
      } else {
        alert("ç„¡æ³•è‡ªå‹•è¤‡è£½ï¼Œè«‹é•·æŒ‰æ‰‹å‹•è¤‡è£½æ–‡å­—ã€‚");
      }
    } catch (e) {
      alert("ç„¡æ³•è‡ªå‹•è¤‡è£½ï¼Œè«‹é•·æŒ‰æ‰‹å‹•è¤‡è£½æ–‡å­—ã€‚");
    }
  }

  document.addEventListener('DOMContentLoaded', updateStates);
  updateStates();
</script>

</body>
</html>